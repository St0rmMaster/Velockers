# Быстрый старт: Заказы и сообщения

## Что нового?

✅ **Заказы** - управление заказами с сайта  
✅ **Сообщения** - ответы на вопросы клиентов  
✅ **Модальное окно** - клиенты могут задавать вопросы прямо из конфигуратора  
✅ **Русский интерфейс** - все переведено на русский язык

## Быстрая установка

### 1. Примените миграцию

```bash
cd exce1sior-configurator
supabase db push
```

### 2. Перезапустите приложение

```bash
npm run dev
```

### 3. Готово!

Откройте админ-панель и увидите новые вкладки:
- **Заказы** - `/admin` → вкладка "Заказы"
- **Сообщения** - `/admin` → вкладка "Сообщения"

## Как использовать

### Для администраторов

#### Просмотр заказов
1. Войдите в админку: `/login`
2. Откройте вкладку **"Заказы"**
3. Выберите заказ для просмотра деталей
4. Измените статус или удалите заказ

#### Ответ на сообщения
1. Откройте вкладку **"Сообщения"**
2. Нажмите на сообщение
3. Введите ответ в текстовое поле
4. Нажмите **"Отправить ответ"**
5. Статус автоматически изменится на "Отвечено"

### Для клиентов

#### Задать вопрос
1. Откройте конфигуратор
2. Нажмите кнопку **"Задать вопрос"**
3. Заполните форму:
   - Имя (обязательно)
   - Email или телефон (хотя бы один)
   - Текст вопроса (обязательно)
4. Нажмите **"Отправить"**
5. Готово! Вы получите ответ на указанный email/телефон

## Фильтры

### Заказы
- Все
- Новый
- В обработке
- Завершен
- Отменен

### Сообщения
- Все
- Новое
- Отвечено
- Закрыто

## Структура базы данных

### Таблица `chat_messages`
```sql
- id (UUID)
- customer_name (TEXT)
- customer_email (TEXT)
- customer_phone (TEXT)
- message (TEXT)
- admin_response (TEXT)
- admin_response_at (TIMESTAMP)
- admin_id (UUID)
- status (TEXT: new, replied, closed)
```

### Таблица `orders` (существующая)
Используется существующая таблица с переведенным интерфейсом.

## Безопасность

✅ RLS (Row Level Security) включен  
✅ Публичные пользователи могут создавать заказы и сообщения  
✅ Только администраторы могут читать и отвечать  

## Troubleshooting

### Проблема: Не вижу вкладки "Заказы" и "Сообщения"
**Решение:** Убедитесь, что вы вошли как администратор (`is_admin()` возвращает true)

### Проблема: Ошибка при отправке сообщения
**Решение:** 
1. Проверьте, применена ли миграция: `supabase db push`
2. Проверьте RLS политики в Supabase Dashboard
3. Убедитесь, что указан email или телефон

### Проблема: Не могу ответить на сообщение
**Решение:** Убедитесь, что вы авторизованы и имеете права администратора

## Дополнительная документация

Полная документация: [`ORDERS_AND_MESSAGES_README.md`](./ORDERS_AND_MESSAGES_README.md)

## Поддержка

При возникновении проблем:
1. Проверьте логи браузера (F12 → Console)
2. Проверьте логи Supabase
3. Убедитесь, что все миграции применены
4. Проверьте права доступа пользователя

---

**Версия:** 1.0.0  
**Дата:** 2025-10-27  
**Проект:** Exce1sior Configurator

