# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å Custom Hull Color

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –æ–ø—Ü–∏–∏ "Custom hull color" –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä–µ.

## üîç –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞
–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ø–æ–ª–µ `metadata` —Ö—Ä–∞–Ω–∏–ª–æ—Å—å **—É—Å—Ç–∞—Ä–µ–≤—à–µ–µ –ø–æ–ª–µ `priceEur`**, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–æ–¥–æ–ª–∂–∞–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–º–µ—Å—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ `priceUsd`.

## ‚úÖ –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. **ProductForm.tsx** (—Å—Ç—Ä–æ–∫–∏ 631-656)
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ —á–∏—Å—Ç–æ–≥–æ metadata –æ–±—ä–µ–∫—Ç–∞ –±–µ–∑ deprecated –ø–æ–ª–µ–π
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `priceUsd`

### 2. **productService.ts** (—Å—Ç—Ä–æ–∫–∏ 173-177)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è `undefined` –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ metadata
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö/deprecated –ø–æ–ª–µ–π

### 3. **catalogLoader.ts** (—Å—Ç—Ä–æ–∫–∏ 199-208)
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å, –µ—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ deprecated –ø–æ–ª–µ
- –ü–æ–º–æ–≥–∞–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ –±—É–¥—É—â–µ–º

### 4. **fix-custom-color-metadata.mjs** (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
- –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ
- –£–¥–∞–ª—è–µ—Ç deprecated –ø–æ–ª–µ `priceEur`
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `priceUsd`

## üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

```bash
cd exce1sior-configurator
node diagnostics/fix-custom-color-metadata.mjs
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:**
- –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ custom color –ø—Ä–æ–¥—É–∫—Ç—ã
- –£–¥–∞–ª—è–µ—Ç `metadata.priceEur`
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ `metadata.priceUsd` –∏ `price_usd`

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Colours** ‚Üí –Ω–∞–π–¥–∏—Ç–µ "Custom hull color"
3. –ò–∑–º–µ–Ω–∏—Ç–µ —Ü–µ–Ω—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ 350 USD)
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ
5. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä
6. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–æ–≤–∞—è —Ü–µ–Ω–∞ –ø—Ä–∏–º–µ–Ω–∏–ª–∞—Å—å

### –®–∞–≥ 3: –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

**–í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ DevTools**
- F12 ‚Üí Application ‚Üí Local Storage
- –£–¥–∞–ª–∏—Ç–µ –∫–ª—é—á `exce1sior.catalog-cache.v1`

**–í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ Dev Settings**
- –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É Dev Settings –≤ –∞–¥–º–∏–Ω–∫–µ
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É –æ—á–∏—Å—Ç–∫–∏ –∫–µ—à–∞

## üõ°Ô∏è –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- ‚úÖ –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É metadata
- ‚úÖ Service —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç deprecated –ø–æ–ª—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- ‚úÖ Loader –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –Ω–∞–ª–∏—á–∏–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç

## üìä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ metadata

```json
{
  "kind": "custom",
  "code": "custom-color",
  "name": { "en": "Custom hull color", "ru": "–ö–∞—Å—Ç–æ–º–Ω—ã–π —Ü–≤–µ—Ç –∫–æ—Ä–ø—É—Å–∞" },
  "description": { "en": "Choose any color", "ru": "–í—ã–±–µ—Ä–∏—Ç–µ –ª—é–±–æ–π —Ü–≤–µ—Ç" },
  "badge": { "en": "free ‚â•3 boats", "ru": "–±–µ—Å–ø–ª–∞—Ç–Ω–æ ‚â•3 –ª–æ–¥–æ–∫" },
  "priceUsd": 300
}
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Ü–µ–Ω—ã

```typescript
metadata.priceUsd    // ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
?? metadata.priceEur // ‚ö†Ô∏è Deprecated (–±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ)
?? row.price_usd     // Fallback
?? row.price_eur     // Legacy fallback
?? 0                 // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

```sql
SELECT 
  id, 
  name, 
  price_usd,
  metadata->>'priceUsd' as metadata_price_usd,
  metadata->>'priceEur' as metadata_price_eur
FROM products 
WHERE type = 'color' AND metadata->>'kind' = 'custom';
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- `metadata_price_eur` = `NULL` ‚úÖ
- `metadata_price_usd` = –∞–∫—Ç—É–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ ‚úÖ
- `price_usd` = –∞–∫—Ç—É–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ ‚úÖ

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–∞—Ç–∞–ª–æ–≥–∞ —Ç–µ–ø–µ—Ä—å –±—É–¥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:

```
‚ö†Ô∏è [catalog] deprecated_field: Custom color has deprecated priceEur field. 
   Please run fix-custom-color-metadata.mjs
```

–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ –±—É–¥—É—â–µ–º.

## ‚ú® –ò—Ç–æ–≥

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è Custom hull color –≤ –∞–¥–º–∏–Ω–∫–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã
- ‚úÖ –ù–µ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–æ–ª–µ–π –≤ metadata
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—â–µ–Ω–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã

